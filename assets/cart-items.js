document.addEventListener("alpine:init",(()=>{Alpine.data("ThemeModule_CartItems",(()=>({itemsRoot:null,locked:null,init(){this.itemsRoot=this.$root,window.addEventListener("shapes:modalcart:afteradditem",(t=>{Alpine.morph(this.itemsRoot,querySelectorInHTMLString("[data-cart-items]",t.detail.response.sections["cart-items"]).outerHTML)})),window.addEventListener("shapes:modalcart:cartqtychange",(t=>{Alpine.morph(this.itemsRoot,querySelectorInHTMLString("[data-cart-items]",t.detail.response.sections["cart-items"]).outerHTML),this.$nextTick((()=>{this.itemsRoot.querySelectorAll("input").forEach((t=>{t.value=t.getAttribute("value")}))}));const e=parseDOMFromString(t.detail.response.sections["cart-live-region"]).firstElementChild.textContent,i=document.getElementById("cart-live-region-text");i.textContent=e,i.setAttribute("aria-hidden",!1),t.detail.originalTarget&&this.$nextTick((()=>{if(!this.itemsRoot.contains(t.detail.originalTarget)){let t;t=this.itemsRoot.closest('[role="dialog"]')?this.itemsRoot.closest('[role="dialog"]').parentNode:this.itemsRoot,this.$focus.within(t).first()}}))}))},itemQuantityChange(t,e){if(this.locked)return;const i=this.$el.closest("li[data-cart-item-key]"),s=t||i.getAttribute("data-cart-item-key"),a=parseInt(isNaN(e)?this.$el.value:e,10),r=fetchConfigDefaults("javascript");r.body=JSON.stringify({id:s,quantity:a,sections:"cart-items,cart-footer,cart-item-count,cart-live-region",sections_url:window.location.pathname});const n=parseInt(this.$el.dataset.lastValue,10);if(a!==n){i.classList.add("opacity-50","cursor-progress");Alpine.raw(Alpine.store("cart_count").count);this.locked=i,fetch(theme.routes.cart_change_url,r).then((t=>t.json())).then((t=>{if(422===t.status){const e=i.querySelector("[data-cart-quantity-error]");e.textContent=t.message,e.style.display="",i.classList.remove("opacity-50","cursor-progress"),this.$el.value=n}else document.body.dispatchEvent(new CustomEvent("shapes:modalcart:cartqtychange",{bubbles:!0,detail:{response:t,originalTarget:i}}))})).catch((()=>{document.getElementById("cart-errors").textContent=theme.strings.cartError})).finally((()=>{this.locked=null}))}},removeItem(t){this.itemQuantityChange(t,0)},_adjustQty(t,e){const i=t.closest("li[key]").querySelector('input[type="number"]'),s=parseInt(i.dataset.lastValue,10);let a;"increment"==e&&(a=s+1),"decrement"==e&&(a=s>1?s-1:1),"remove"==e&&(a=0),i.value=a,i.dispatchEvent(new Event("change",{bubbles:!0}))},increment(){this._adjustQty(this.$el,"increment")},decrement(){this._adjustQty(this.$el,"decrement")},remove(){this._adjustQty(this.$el,"remove")}})))}));